---
title: "Railsã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã®ãƒ«ãƒ¼ãƒ«ä¸€è¦§"
emoji: "ğŸ‘Œ"
type: "tech"
topics: ["rails"]
published: true
---

`bin/rails g migration <ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å> <ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å:ãƒ‡ãƒ¼ã‚¿å‹>`ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã®ã¯Railsãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ãŠé¦´æŸ“ã¿ã§ã™ãŒã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã£ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å¤‰ã‚ã£ã¦ãã¾ã™ã€‚

ã“ã‚Œã‚‚Railsãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ãŠé¦´æŸ“ã¿ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€Railsãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚„Railsã®æ›¸ç±ã«ã¯ã‚ã¾ã‚Šæ›¸ã‹ã‚Œã¦ã„ãªã‹ã£ãŸã®ã§ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

|ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã®ãƒ‘ã‚¿ãƒ¼ãƒ³|ç”Ÿæˆã•ã‚Œã‚‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«|
| --- | --- |
|add_<*>_to_TABLENAME|add_column|
|remove_<*>_from_TABLENAME|remove_column|
|create_TABLENAME|create_table|
|<*>join_table|create_join_table|
	
Railsã‚¬ã‚¤ãƒ‰ã®[Active Record ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³](https://railsguides.jp/active_record_migrations.html)ã‚’ç¢ºèªã™ã‚‹ã¨ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç•°ãªã£ã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚

## add_<>_to_TABLENAME

`add_<>_to_TABLENAME`ã§ã¯`add_column`ãŒä½œã‚‰ã‚Œã¾ã™ã€‚

```
$ rails generate migration AddPartNumberToProducts part_number:string
```

```ruby
class AddPartNumberToProducts < ActiveRecord::Migration[5.0]
  def change
    add_column :products, :part_number, :string
  end
end
```

## remove_<>_from_TABLENAME

`remove_<>_from_TABLENAME`ã§ã¯`remove_column`ãŒä½œã‚‰ã‚Œã¾ã™ã€‚

```
$ rails generate migration RemovePartNumberFromProducts part_number:string
```

```ruby
class RemovePartNumberFromProducts < ActiveRecord::Migration[5.0]
  def change
    remove_column :products, :part_number, :string
  end
end
```

## create_TABLENAME

`create_TABLENAME`ã§ã¯`create_table`ãŒä½œã‚‰ã‚Œã¾ã™ã€‚

```
$ rails generate migration CreateProducts name:string 
```

```ruby
class CreateProducts < ActiveRecord::Migration[5.0]
  def change
    create_table :products do |t|
      t.string :name
      t.string :part_number

      t.timestamps
    end
  end
end
```

## create_join_table

`create_join_table_<>`ã ã¨`create_join_table`ãŒä½œã‚‰ã‚Œã¾ã™ã€‚

```
$ rails g migration CreateJoinTableCustomerProduct customer product
```

```ruby
class CreateJoinTableCustomerProduct < ActiveRecord::Migration[5.0]
  def change
    create_join_table :customers, :products do |t|
      # t.index [:customer_id, :product_id]
      # t.index [:product_id, :customer_id]
    end
  end
end
```

## ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ã‚½ãƒƒãƒ‰

|ãƒ¡ã‚½ãƒƒãƒ‰|èª¬æ˜|
| --- | --- |
|add_column|ã‚«ãƒ©ãƒ ã®è¿½åŠ |
|remove_column|ã‚«ãƒ©ãƒ ã®å‰Šé™¤|
|change_column|ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿å‹ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å¤‰æ›´|
|change_column_null|ã‚«ãƒ©ãƒ ã®nullè¨±å¯è¨­å®šã‚’å¤‰æ›´|
|change_column_default|ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’å¤‰æ›´|
|rename_column|ã‚«ãƒ©ãƒ åã‚’å¤‰æ›´|
|add_index|ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¿½åŠ |
|remove_index|ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å‰Šé™¤|
|create_table|ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ|
|drop_table|ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰Šé™¤|
|rename_table|ãƒ†ãƒ¼ãƒ–ãƒ«åã®å¤‰æ›´|



## ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

`db/schema.rb`ãŒã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚
éå»ã«å®Ÿè¡Œã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®çµæœãŒã™ã¹ã¦çµ±åˆã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚

schema.rbã¯Rubyã®DSLã§ã™ãŒã€SQLã¨ã—ã¦ä¿å­˜ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

`config/application.rb`å†…ã§`config.active_record.schema_format = :sql`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ã‚’SQLã«å¤‰æ›´ã§ãã¾ã™ã€‚