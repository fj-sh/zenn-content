---
title: "Next.jsã®é™çš„ã‚µã‚¤ãƒˆã«Prismã‚’ä½¿ã£ã¦ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å½“ã¦ã‚‹"
emoji: "ğŸ’¬"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs"]
published: true
---

Next.js ã§ Static Generation ã—ãŸã‚µã‚¤ãƒˆã§ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å½“ã¦ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãŒ...

![](https://storage.googleapis.com/zenn-user-upload/bd5d3f61f4cc-20220521.jpg)

ã“ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/3a9ee9c54ef8-20220521.jpg)

å¿…è¦ãªéƒ¨åˆ†ã‚’æŠœç²‹ã—ãªãŒã‚‰ç´¹ä»‹ã—ã¾ã™ã€‚

```console
npm i remark remark-prism remark-html
```

```js
type PostHtmlResult = {
  html: string
  contentLength: number
}

async function markdownToHtml(markdown: string) {
  const result = await remark()
    .use(html, { sanitize: false })
    .use(remarkPrism, { plugins: ['line-numbers'] })
    .process(markdown)

  return result.toString()
}

async function getPostHtml(fullPathToFile: string): Promise<PostHtmlResult> {
  // ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
  const fileContents = fs.readFileSync(fullPathToFile, "utf8");
  // ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’ HTML ã«å¤‰æ›ã™ã‚‹
  const html = await markdownToHtml(matter(fileContents).content);
  // æ–‡å­—æ•°ã‚’å–å¾—ã™ã‚‹ï¼ˆåˆ¥ã«ã—ãªãã¦ã‚‚ã„ã„ï¼‰
  const contentLength = matter(fileContents).content.length;
  return {
    html,
    contentLength,
  };
}
```

ä¸Šæ›¸ãã™ã‚‹ CSS ã‚’ä½œæˆã—ã¾ã™ã€‚

```css:styles/prism-overrides.css
:root {
  --highlight-background: rgb(0 0 0 / 0);
  --highlight-width: 0;
}

.remark-highlight pre{
  border-radius: 10px;
  box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px;
}

```

`pages/_app.tsx` ã§ CSS ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

```diff js:pages/_app.tsx
import { CssBaseline, ThemeProvider } from '@mui/material'
+ import '../styles/prism-overrides.css'
import theme from '../lib/theme'

const App = ({ Component, pageProps }: AppProps) => (
    // ç•¥
```

è‡ªåˆ†ã¯ Prism ã‚’å½“ã¦ãŸãƒšãƒ¼ã‚¸ã‚’ `pages/[id].tsx` ã§è¡¨ç¤ºã•ã›ã¦ã„ã‚‹ã®ã§ã€`pages/[id].tsx` ã‚’ç·¨é›†ã—ã¾ã™ã€‚

è‰²ã€…ã¨çœç•¥ã—ã¦ã„ã¾ã™ãŒã€ä¸Šã§ä½œã£ãŸé–¢æ•° `getPostHtml`ã‹ã‚‰å–å¾—ã—ãŸ `html` ã‚’ Props çµŒç”±ã§ JSX ã«æ¸¡ã—ã€ `<div dangerouslySetInnerHTML={{ __html: fullContentPost.html }} />` ã®ã‚ˆã†ã«ã—ã¦ HTML ã‚’è¡¨ç¤ºã•ã›ã‚Œã° OK ã§ã™ã€‚

```js:pages/[id].tsx
import 'prismjs/themes/prism-tomorrow.css'

type PostProps = {
  fullContentPost: FullContentPost
}

const Post: NextPage<PostProps> = ({ fullContentPost }: PostProps) => {

return (
    <>
        <div className="main">
            <article className="article">
                <div dangerouslySetInnerHTML={{ __html: fullContentPost.html }} />
            </article>
        </div>
        <style jsx>{`
            .article {
                width: 100%;
            }
        `}</style>
    </>
  )
}

export default Post

interface IParams extends ParsedUrlQuery {
  id: string
}

export const getStaticProps: GetStaticProps = async (context) => {
  const { id } = context.params as IParams
  // ã“ã® fullContentPost ã¯ html ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤
  const fullContentPost = await getFullContentById(id)
  return {
    props: {
      fullContentPost,
    },
  }
}


```

ã“ã‚Œã§è¨˜äº‹å†’é ­ã®ç”»åƒã®ã‚ˆã†ãªè¦‹ãŸç›®ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

## å‚è€ƒ

[Syntax Highlighting (and More!) With Prism on a Static Site](https://css-tricks.com/syntax-highlighting-prism-on-a-next-js-site/)
